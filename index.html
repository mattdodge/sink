<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Sink by mattdodge</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Sink</h1>
          <h2>Keep remote directories in &quot;sink&quot; with GitHub repositories using webhooks</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/mattdodge/sink/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/mattdodge/sink/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/mattdodge/sink" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="sink" class="anchor" href="#sink" aria-hidden="true"><span class="octicon octicon-link"></span></a>sink</h1>

<p>One webhook to rule them all.</p>

<p>Often times, an organization will have multiple directories on a web server that need to be synced to individual GitHub repositories. Ideally, these directories would support some sort of Continuous Deployment as well. Toss in different branches with something like <a href="http://nvie.com/posts/a-successful-git-branching-model/">git flow</a> and maintaining webhooks can get unruly pretty fast.</p>

<p>This repository aims to provide a one-stop-shop for all of your GitHub webhooks, relying on server-side config to keep different directories synced up with different branches on different repositories. With the <a href="https://github.com/blog/1933-introducing-organization-webhooks">recent addition of organization-wide webhooks</a>, administrators will ideally only need one webhook to keep all of their directories in "sink".</p>

<h2>
<a id="basic-usage" class="anchor" href="#basic-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basic Usage</h2>

<ol>
<li>
<p>In some accessible directory on your web server, clone down sink. For example:</p>

<div class="highlight highlight-sh"><pre><span class="pl-s3">cd</span> /var/www
git clone https://github.com/mattdodge/sink.git</pre></div>
</li>
<li>
<p>Copy <code>config.ini.example</code> to <code>config.ini</code> and modify its contents to match your desired implementation. See <a href="https://github.com/mattdodge/sink/wiki/Documentation">the wiki</a> for more documentation on configuration options.</p>

<p><strong>Be sure to change your SECRET_PHRASE, you will need it in the next step.</strong></p>
</li>
<li>
<p>From your GitHub organization or from an individual repo, add a webhook to point to your recently cloned sync directory. Following up on our previous example:</p>

<ul>
<li>
<strong>Payload URL</strong>: <em><a href="http://yourhost.com/sink/">http://yourhost.com/sink/</a></em>
</li>
<li>
<strong>Content-Type</strong>: <em>application/json</em>
</li>
<li>
<strong>Secret</strong>: <em>The secret phrase you configured in step 2</em>
</li>
</ul>
</li>
</ol>

<h4>
<a id="adding-a-sink" class="anchor" href="#adding-a-sink" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding a sink</h4>

<p>If you want to keep a directory on your web server synced with a branch of a remote repository, it's as easy as adding this to your <code>config.ini</code></p>

<div class="highlight highlight-ini"><pre><span class="pl-en">[live site]</span>
  <span class="pl-k">GITHUB_ACCOUNT</span> = mattdodge
  <span class="pl-k">GITHUB_REPO</span> = sink
  <span class="pl-k">GITHUB_BRANCH</span> = master
  <span class="pl-k">DIRECTORY</span> = <span class="pl-s1"><span class="pl-pds">"</span>/var/www/homepage<span class="pl-pds">"</span></span></pre></div>

<h2>
<a id="why" class="anchor" href="#why" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why?</h2>

<p>A couple of different things inspired this script, if you can relate to any of these, sink may be for you.</p>

<ul>
<li>More and more web servers are coming with SSH access and git installed on them. Might as well make use of them!</li>
<li>
<p>I normally find myself having multiple web apps on a single web server. I also like to version control each web app in a separate repository. Frankly, I just got really tired of running the following commands over and over and over</p>

<div class="highlight highlight-sh"><pre>ssh matt@webserver
<span class="pl-s3">cd</span> path/to/webappD
git pull</pre></div>
</li>
<li>It's pretty easy to add a simple endpoint that <code>cd</code>'s into the directory, and then pull the code down. The problem is you have to add a webhook to each repository and keep track of them all. This is what I used to do, but I never liked how it would pull down on every push to every branch. </li>
<li>Like I mentioned earlier, I'm a huge proponent of <a href="http://nvie.com/posts/a-successful-git-branching-model/">git flow</a>. I wanted a way to keep my staging servers in sync with my <strong>develop</strong> branch and my production servers in sync with <strong>master</strong> without having different scripts and different webhooks.</li>
<li>CI tools typically integrate pretty easily with GitHub, but they are really too heavy for what you normally need just when syncing a repo.</li>
</ul>

<h2>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>Check out more documentation about the configuration options in the <a href="https://github.com/mattdodge/sink/wiki/Documentation">Documentation Wiki</a>.</p>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h2>

<p>We've got a couple of cool examples of using sink in the <a href="https://github.com/mattdodge/sink/wiki/Cool-Examples">Examples Wiki</a></p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p><a href="http://opensource.org/licenses/MIT">MIT</a> - you know the drill, blah blah blah</p>
        </section>

        <footer>
          Sink is maintained by <a href="https://github.com/mattdodge">mattdodge</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>